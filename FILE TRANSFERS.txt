XMIT
xmit user.node dsn('hlq.ql') outdsn('hlq.ql')
receive indsn('hlq.ql')

--------------------------------------------

Connect Direct Manuals
https://www.ibm.com/docs/en/scfz/5.2.0?topic=zos-signon-command
https://www.ibm.com/docs/en/scfz/5.2.0?topic=command-using-signon-through-batch-interface
https://www.ibm.com/docs/en/scfz/5.2.0?topic=sessions-signing-sterling-connectdirect-zos
https://www.ibm.com/docs/en/scfz/5.2.0?topic=zos-using-signon-through-iui
https://www.ibm.com/docs/en/scfz/5.2.0?topic=iui-setting-up-signon-defaults
https://www.ibm.com/docs/en/scfz/5.2.0?topic=iui-viewing-your-current-signon-parameters
https://www.ibm.com/docs/en/connect-direct/6.1.0?topic=errors-signon-iuiapi
https://www.ibm.com/docs/en/connect-direct/6.1.0?topic=administrative-connectdirect-secure-plus-commands
https://www.ibm.com/docs/en/connect-direct/6.1.0?topic=options-adding-remote-node-record-external-authentication-server
https://www.ibm.com/docs/en/connect-direct/6.1.0?topic=administrative-connectdirect-secure-plus-commands
https://www.ibm.com/docs/en/connect-direct/6.1.0?topic=zos-enable-validate-connectdirect-secure-plus-operation
https://www.ibm.com/docs/en/connect-direct/6.1.0?topic=zos-troubleshooting

--------------------------------------------

WINSCP

winscp.exe /console

open hostname
put C:/sadsad/asdad.txt HLQ.DATASET    // NO QUOTES

open -passive=off ftpes://${useridpass}:$cpassword@$hostname/
call site file=jes
ascii  //  binary
put ftpjcl.txt
exit

--------------------------------------------

FTP USEFUL

SITE        -FTP default
QUOTE SITE  -Windows
LOCSITE     -zOS
CALL SITE   -WinSCP

quote site:
JESJOBNAME
JESSTATUS
JESOWNER

https://www.ibm.com/support/pages/sitelocsite-commands-mvs-ftp

Ftp -d -v -f "//'FTPDATA.DSN'"

For PDS:
cd NEXTLQ: Like if the PDS is USERID.PDS(*)
You do:
open hostname (working directory "HLQ.")
cd PDS
mput or mget

For Binary Files:
https://www.ibm.com/support/pages/transfer-ptf-binary-bin-file-your-pc-mvs-system
Define the file attributes as: FB, LRECL 1024, BLKSIZE 27648
Use mput for the file transfer.

SYSFTPD DD statement
DSN=dsnname,DISP=SHR
PATH

FTP
https://www.ibm.com/docs/en/zos/2.4.0?topic=ftpdata-summary-ftp-client-server-configuration-statements
Subcommands to the server
https://www.ibm.com/docs/en/zos/2.3.0?topic=codes-ftp-subcommand
batch
https://www.ibm.com/docs/en/zos/2.4.0?topic=ftp-submitting-requests-in-batch


https://www.ibm.com/docs/en/zos/2.1.0?topic=ftp-ddname-support
https://www.ibm.com/docs/en/zos/2.2.0?topic=protocol-keyring-ftp-client-server-statement
parameters
https://www.ibm.com/docs/en/zos/2.2.0?topic=ftp-command-entering-environment
https://www.ibm.com/docs/en/zos/2.1.0?topic=ftp-preparing-environment
https://community.bmc.com/s/article/How-can-I-use-variable-names-for-my-FTP-dataset-names
https://www.ibm.com/docs/en/zos/2.2.0?topic=applications-environment-variables

NETRC
https://www.ibm.com/docs/en/zos/2.3.0?topic=ftp-netrc-data-set
https://www.ibm.com/docs/en/zos/2.1.0?topic=host-using-netrc-data-set

ENVAR
https://www.ibm.com/support/pages/specifying-tcpip-server-parameters-jcl

SYSFTPD DD statement

FTPDATA CLIENT

  SECURE_MECHANISM  TLS
  TLSRFCLEVEL       RFC4217
  TLSMECHANISM      ATTLS    ; connect at TLS 1.2 or higher
  SECURE_FTP        REQUIRED
  SECURE_CTRLCONN   CLEAR    ; Commands may be clear (unencrypted).
  SECURE_DATACONN   PRIVATE  ; Payload must be encrypted.
  EPSV4             TRUE

FTPDATA CLIENT DEBUG

DEBUG SEC
DEBUG TIM
DEBUG BAS
DEBUG FLO
DEBUG ALL

mvsget 'SYS3.¿SYNCLINK' +
'SYS3.SYNCLINK'
https://www.ibm.com/docs/en/zos/2.3.0?topic=ftp-examples-get-mget-mvsget-subcommands

put
get
mput  - Copies all members from a PDS to another, it should be created
mget
mvsput - Allocates file with same attributes and copies all members
mvsget

EXAMPLE:
                                 
lcd 'SYS3.R31'                   
type i                                    
locsite fwf                               
locsite lrecl=1024 recfm=fb blksize=6144  
locsite track pri=350 sec=100 vol=INST04  
mget *.F1 (repl                           
mget *.F2 (repl                           
mget *.SMPMCS (repl                       
mget *.JCL (repl                          
type a                                    
locsite lrecl=80   recfm=fb blksize=3120  
locsite track pri=2  sec=1 vol=INST04     
mget *.TXT (repl                          
quit    

1	AMBIGUOUS	false
2	?	false
3	ACCT	true
4	APPEND	true
5	ASCII	true
6	BINARY	true
7	CD	true
8	CLOSE	true
9	TSO	false
10	OPEN	true
11	DEBUG	false
12	DELIMIT	false
13	DELETE	true
14	DIR	true
15	EBCDIC	true
16	GET	true
17	HELP	false
18	LOCSTAT	true
19	USER	true
20	LS	true
21	MDELETE	true
22	MGET	true
23	MODE	true
24	MPUT	true
25	NOOP	true
26	PASS	true
27	PUT	true
28	PWD	true
29	QUIT	true
30	QUOTE	true
31	RENAME	true
32	SENDPORT	true
33	SENDSITE	false
34	SITE	false
35	STATUS	true
36	STRUCTURE	true
37	SUNIQUE	true
38	SYSTEM	true
40	TYPE	true
41	LCD	true
42	LOCSITE	true (see previous note in FTP subcommand codes)
43	LPWD	false
44	MKDIR	true
45	LMKDIR	true
46	EUCKANJI	true
47	IBMKANJI	true
48	JIS78KJ	true
49	JIS83KJ	true
50	SJISKANJI	true
51	CDUP	true
52	RMDIR	true
53	HANGEUL	true
54	KSC5601	true
55	TCHINESE	true
56	RESTART	false
57	BIG5	true
58	BLOCK	true
59	COMPRESS	true
60	FILE	true
61	PROXY	true
62	RECORD	true
63	SCHINESE	true
64	STREAM	true
65	GLOB	false
66	PROMPT	false
67	UCS2	true
68	!	true
70	DUMP	false
71	VERBOSE	false
72	CLEAR	true
73	CPROTECT	true
74	PRIVATE	true
75	PROTECT	true
76	SAFE	false
77	CCC	true
78	LANGUAGE	true
79	FEATURE	true
80	SRESTART	true
81	AUTH	true
82	mkfifo	true
83	MVSGET	true
84	MVSPUT	true

+search order
https://www.ibm.com/docs/en/zos/2.2.0?topic=protocol-ftp-configuration-statements-in-ftpdata

tso ftp hostname -v -f "//'HLQ.QL(member)'"

TSO shell
-f
SYSFTPD DD statement
tso_prefix.FTP.DATA
userid.FTP.DATA
/etc/ftp.data
SYS1.TCPPARMS(FTPDATA) data set
tcpip_hlq.FTP.DATA file

UNIX System Services shell
-f
$HOME/ftp.data
userid.FTP.DATA
/etc/ftp.data
SYS1.TCPPARMS(FTPDATA) data set
tcpip_hlq.FTP.DATA file
--------------------------------------------

FTP to JES:
open hostname
userid
password
prompt off
quote site file=jes
dir

SITE / LOCSITE / QUOTE SITE / CALL SITE

SITE VARrecfm LRECL=32760 RECFM=U BLKSIZE=32760

+LOCSITE
https://www.ibm.com/docs/en/zos/2.2.0?topic=subcommands-locsite-subcommand-specify-site-information-local-host#locsite

A z/OS® FTP client can use a virtual CERTAUTH key ring to authenticate the FTP server by following these steps:
The user specifies the following KEYRING directive in her FTP.DATA file:
KEYRING *AUTH*/*

The user directs FTP to use TLS by specifying -a TLS or -r TLS on the FTP command:
ftp –r TLS ftp.ibm.com
-d -v -f 


-----------------------------------------



SSH

https://ma.ttias.be/ssh-error-unable-negotiate-ip-no-matching-cipher-found/

START:
# Start the SSH daemon                                                       
_BPX_JOBNAME='SSHD' /usr/sbin/sshd -f /etc/ssh/sshd_config 2>/dev/console &  
                                                                             
                                                                             
# Start the sftp daemon                                                      
_BPX_JOBNAME='SSHDF' /usr/sbin/sshd -f /etc/ssh/sftpd_config 2>/dev/console &



Config:

Host hostname
   Port 22
   IdentityFile ~/.ssh/asd.rsa

kill -s HUP $(cat /var/run/sshdf.pid)
ssh -vvv -c aes256-cbc -p 8022 8.8.8.8
sftp -c aes256-cbc -P 8022 8.8.8.8
Sftp -o "StrictHostkeyChecking no"

ssh-keyscan -H -t rsa 8.8.8.8  >> ~/.ssh/known_hosts

usage: ssh Ýoptions¨ Ýuser@¨host Ýcommand¨
Options:
  -4          Use IPv4 addresses only.
  -6          Use IPv6 addresses only.
  -A          Enables authentication agent forwarding.
  -a          Disables authentication agent forwarding (default).
  -C          Enables compression.
  -f          Fork into background after authentication.
  -G          Causes ssh to print its configuration after evaluating Host and Ma
tch blocks and exit.
  -g          Allow remote hosts to connect to local forwarded ports.
  -K          Enables forwarding (delegation) of GSSAPI credentials to the serve
r.
  -k          Disables forwarding (delegation) of GSSAPI credentials to the serv
er.
  -M          Places the ssh client into master mode for connection sharing.
  -N          Do not execute a shell or command.
  -n          Redirect input from /dev/null.
  -q          Quiet mode; suppress most warning and diagnostic messages.
    -q          Quiet mode; suppress most warning and diagnostic messages.
  -s          Invoke command (mandatory) as SSH2 subsystem.
  -T          Disables pseudo-tty allocation.
  -t          Force pseudo-tty allocation.
  -V          Display version number only.
  -v          Verbose mode; display verbose debugging messages.
              Multiple -v increases verbosity.
  -X          Enables X11 connection forwarding.
  -x          Disables X11 connection forwarding (default).
  -Y          Enables trusted X11 forwarding.
  -y          Send log information to syslog.
  -b addr     Local IP address.
  -c cipher   Select encryption algorithm.
  -D Ýbind-addr:¨port     Enables dynamic application-level port forwarding.
  -e char     Set escape character; ``none'' = disable (default: ~).
  -E file     Append debug logs to file instead of standard error.
  -F config   Config file (default: ~/.ssh/config).
  -i file     Identity for public key authentication.
  -J Ýuser@¨hostÝ:port¨¨     Shortcut to specify a ProxyJump configuration direc
tive.
tive.
  -L Ýbind_address:¨port:host:hostport   Forward local port to remote address.
  -L Ýbind_address:¨port:remote_socket   Forward local port to remote socket.
  -L local_socket:host:hostport          Forward local socket to remote address.
  -L local_socket:remote_socket          Forward local socket to remote socket.
  -l user     Log in using this user name.
  -m macs     Specify MAC algorithms.
  -O ctl-cmd  Control an active connection multiplexing master process.
  -o 'option' Process the option as if it was read from a configuration file.
  -p port     Port to connect to on the remote host.
  -Q cipher | cipher-auth | mac | kex | key | key-cert | key-plain | protocol-ve
rsion   Queries ssh for the supported algorithms.
  -R Ýbind_address:¨port:host:hostport   Forward remote port to local address.
  -R Ýbind_address:¨port:local_socket    Forward remote port to local socket.
  -R remote_socket:host:hostport         Forward remote socket to local address.
  -R remote_socket:local_socket          Forward remote socket to local socket.
  -R Ýbind_address:¨port                 Forward remote port to using SOCKS.
  -S ctl-path Specifies the location of a control socket for connection sharing.
  -W host:port   Requests that client standard input and output be forwarded.

# ssh-keyscan -h
unknown option -- h
usage: ssh-keyscan Ý-46cHv¨ Ý-f file¨ Ý-p port¨ Ý-T timeout¨ Ý-t type¨
                   Ýhost | addrlist namelist¨ ...

SFTP

https://www.ibm.com/docs/en/zos/2.4.0?topic=guide-accessing-mvs-data-sets-within-sftp
https://www.ibm.com/docs/en/zos/2.1.0?topic=utility-invoking-bpxbatch-in-batch-job

# sftp -h
usage: sftp Ý-46aCfpqrv¨ Ý-B buffer_size¨ Ý-b batchfile¨ Ý-c cipher¨
          Ý-D sftp_server_path¨ Ý-F ssh_config¨ Ý-i identity_file¨ Ý-l limit¨
          Ý-o ssh_option¨ Ý-P port¨ Ý-R num_requests¨ Ý-S program¨
          Ý-s subsystem | sftp_server¨ host
       sftp Ýuser@¨hostÝ:file ...¨
       sftp Ýuser@¨hostÝ:dirÝ/¨¨
       sftp -b batchfile Ýuser@¨host

https://www.ibm.com/docs/en/zos/2.2.0?topic=ssftp-options

https://www.ibm.com/docs/en/zos/2.2.0?topic=program-host-key-checking
https://www.ibm.com/docs/en/integration-bus/10.0?topic=sftp-known-host-checking

CONFIG FILE syntax

Host hostname
   Port 22
   IdentityFile ~/.ssh/id_rsa

ssh-keygen -t rsa
ssh-keygen -t dsa

ssh -Q mac and ciphers
HLQ.SSH.CNTL(SSHJOBS1)
ssh-keygen -i -f testkey.putty.pub >>  /USERIDHOME/.ssh/authorized_keys

zOS Open SSH uses BASE64 encoding. 


BE CAREFUL on how it is uploaded. When you upload a key file, it might get encoded in a different way.
ssh-keygen -i -m RFC4716 -f /u/user/pub >>  /u/user/pubibm

ssh-keygen help

usage: ssh-keygen Ýoptions¨
  ssh-keygen Ý-q¨ Ý-b bits¨ Ý-t type¨ Ý-o¨ Ý-a rounds¨ Ý-N new_passphrase¨ Ý-C comment¨ Ý-f output_keyfile¨
  ssh-keygen -p Ý-P old_passphrase¨ Ý-N new_passphrase¨ Ý-f keyfile¨
  ssh-keygen -i Ý-m key_format¨ Ý-f input_keyfile¨
  ssh-keygen -e Ý-m key_format¨ Ý-f input_keyfile¨
  ssh-keygen -e Ý-m key_format¨ Ý-f input_keyfile¨
  ssh-keygen -y Ý-f input_keyfile¨
  ssh-keygen -c Ý-P passphrase¨ Ý-C comment¨ Ý-f keyfile¨
  ssh-keygen -l Ý-v¨ Ý-E fingerprint_hash¨ Ý-f input_keyfile¨
  ssh-keygen -B Ý-f input_keyfile¨
  ssh-keygen -F hostname Ý-f known_hosts_file¨ Ý-l¨
  ssh-keygen -H Ý-f known_hosts_file¨
  ssh-keygen -R hostname Ý-f known_hosts_file¨
  ssh-keygen -r hostname Ý-f input_keyfile¨ Ý-g¨
  ssh-keygen -G output_file Ý-v¨ Ý-b bits¨ Ý-M memory¨ Ý-S start_point¨
  ssh-keygen -T output_file -f input_file Ý-v¨ Ý-a rounds¨ Ý-J num_lines¨ Ý-j start_line¨ Ý-K checkpt¨ Ý-W generator¨
  ssh-keygen -s ca_key -I certificate_identity Ý-h¨ Ý-U¨ Ý-n principals¨ Ý-O option¨ Ý-V validity_interval¨ Ý-z serial_number¨ file
...
  ssh-keygen -L Ý-f input_keyfile¨
  ssh-keygen -A
  ssh-keygen -k -f krl_file Ý-u¨ Ý-s ca_public¨ Ý-z version_number¨ file ...
  ssh-keygen -Q -f krl_file file ...
Options:
  -A          Generate non-existent host keys for all key types.
  -a rounds   Number of KDF rounds used or number of tests for screening DH-GEX moduli (with -T).
  -B          Show bubblebabble digest of key file.
  -b bits     Number of bits in the key to create.
 -C comment  Provide new comment.
 -c          Change comment in private and public key files.
 -d          Same as '-t dsa'; Specifies dsa type key.
 -E          Display key fingerprints using hash algorithm: md5 |sha256
 -e | -x     Export OpenSSH to foreign format key file.
 -F hostname Find hostname in known hosts file.
 -f filename Filename of the key file.
 -G file     Generate candidates for DH-GEX moduli.
 -g          Use generic DNS resource record format.
 -H          Hash names in known_hosts file.
 -h          Generate host certificate instead of a user certificate.
 -I key_id   Key identifier to include in certificate.
 -i | -X     Import foreign format to OpenSSH key file.
 -J number   Screen this number of moduli lines.
 -j number   Start screening moduli at specified line.
 -K checkpt  Write checkpoints to this file.
 -k          Generate a KRL file.
 -L          Print the contents of a certificate.
 -l          Show fingerprint of key file.
 -M memory   Amount of memory (MB) to use for generating DH-GEX moduli.
 -m key_fmt  Conversion format for -e/-i (PEM|PKCS8|RFC4716).
 -N phrase   Provide new passphrase.
 -n name,... User/host principal names to include in certificate
 -O option   Specify a certificate option.
-o          Save private keys using the new OpenSSH format.
-P phrase   Provide old passphrase.
-p          Change passphrase of private key file.
-Q          Test whether key(s) are revoked in KRL.
-q          Quiet.
-R hostname Remove host from known_hosts file.
-r hostname Print DNS resource record.
-S start    Start point (hex) for generating DH-GEX moduli.
-s ca_key   Certify keys with CA key.
-T file     Screen candidates for DH-GEX moduli.
-t type     Specify type of key to create: dsa | ecdsa | ed25519 | rsa
-U          Indicates that a CA key resides in a ssh-agent.
-u          Update KRL rather than creating a new one.
-V from:to  Specify certificate validity interval.
-v          Verbose.
-W gen      Generator to use for generating DH-GEX moduli.
-y          Read private key file and print public key.
-z serial   Specify a serial number.

  
https://askubuntu.com/questions/123072/ssh-automatically-accept-keys
https://serverfault.com/questions/638600/auto-accept-rsa-key-fingerprint-from-command-line
https://stackoverflow.com/questions/21383806/how-can-i-force-ssh-to-accept-a-new-host-fingerprint-from-the-command-line#comment108409638_53672867
https://www-01.ibm.com/servers/resourcelink/svc00100.nsf/pages/zOSV2R4sc276806/$file/foto100_v2r4.pdf
https://www.ibm.com/support/pages/example-batch-sftp-script
https://www.ibm.com/docs/en/zos/2.3.0?topic=administrators-starting-sshd-daemon
https://www.ibm.com/docs/en/zos/2.3.0?topic=SSLTBW_2.3.0/com.ibm.zos.v2r3.foto100/bpxstart.htm
https://www.ibm.com/docs/en/zos/2.3.0?topic=SSLTBW_2.3.0/com.ibm.zos.v2r3.foto100/fotz118.htm
https://www.ibm.com/docs/en/zos/2.3.0?topic=SSLTBW_2.3.0/com.ibm.zos.v2r3.foto100/fotz117.htm
https://www.ibm.com/docs/en/zos/2.3.0?topic=daemon-restarting-sshd-without-bringing-it-down
https://www.ibm.com/docs/en/zos/2.2.0?topic=descriptions-zos-openssh
https://www.ibm.com/docs/en/zos/2.3.0?topic=daemon-ways-start-sshd-as-stand-alone



